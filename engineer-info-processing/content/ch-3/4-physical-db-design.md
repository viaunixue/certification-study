# 물리 데이터 베이스 설계

## 물리 요소 조사 분석

### 분산 데이터베이스 
| 장점 | 단점 |
|:----:|:----:|
| - 분산 제어가 용이<br>- 지역 자치성 높음<br>- 효용성과 융통성 높음<br>- DB 복제 및 분산 통한 <br>사용자 측면 향상된 성능 제공<br>- 장애로 인한 데이터 유실 복구<br>- 시스템 확장에 용이       | <br>- 복잡성이 증가<br>- 성능 저하<br>- 개발 비용의 증가     |

### 분산 데이터베이스 투명성
> 위 복병 분장

| 위치 투명성 | 사용자나 응용 프로그램이 접근할 데이터의 물리적 위치 |
| ---- | ---- |
| 복제 투명성 | 사용자 응용프로그램이 접근할 데이터가 물리적으로 <br>여러 곳에 복제되어 있는지 여부를 알 필요가 없는 상황 |
| 병행 투명성 | 여러 사용자나 응용 프로그램이 동시에 <br>분산 DB에 대한 트랜잭션을 수행하는 경우에도,<br>결과에 이상이 발생하지 않았다 |
| 분할 투명성 | 사용자가 하나의 논리적 릴레이션이 여러 단편으로 분할되어<br>각 단편의 사본이 여러 장소에 저장되어 있음을 알 필요가 없는 성질 |
| 장애 투명성 | DB가 분산되어 있어 있는 각 지역의 시스템이나 통신망에 <br>이상이 생기더라도 **데이터의 무결성을 보존할 수 있는 성질**<br>ex. 2PC(Phase Commit) |
| 위치 투명성 | 물리적 위치를 알아야 할 필요가 없는 성질 |

### 접근 제어 정책
1. 신원 기반 (Identity-based) 접근 제어 정책
   *  DAC (Discretionary Access Control)
2.  규칙 기반 (Rule-based) 접근 제어 정책
   * MAC (Mandatory Access Control)
3. 역할 기반 (Role-based) 접근 제어 정책
   * RBAC (Role Based Access Control)
## DB 물리 속성 설계

### 파티셔닝 특징
1. 물리적 파티셔닝으로 전체 데이터 훼손될 가능성이 줄어들고 데이터 가용성 향상
2. DB를 작은 단위로 관리하여 편리
3. 부하를 각각 작은 단위로 분산시켜 성능을 향상
4. 병렬 DB 환경 중 수평분할에 활용되는 분할 기법

### 파티셔닝 유형
| 유형 | 설명 |
| :--: | :--: |
| 레인지 파티셔닝 | 분할 키 값이 범위 내 있는지 여부로 구분하는 기법 |
| 해시 파티셔닝 | 해시 함수의 값이 따라 파티션에 포함할지 여부를 결정하는 기법 |
| 리스트 파티셔닝 | 값 목록에 파티션을 할당하고 분할 키 값을 그 목록에 비춰 선택하는 기법 |
| 컴포지트 파티셔닝 | 레인지/해시/리스트 파티셔닝 중 2개 이상 파티셔닝을 결합하는 기법 |
| <br>라운드 로빈 파티셔닝 | 라운드 로빈 분할로 회전, 새로운 행이 파티션에 할당하는 방식<br>파티션에 행의 고른 분포를 원할 때 사용<br>분할 컬럼을 명시할 필요가 없음<br>테이블은 기본 키가 반드시 필요하지 않음 |
### 클러스터링 개념
1. 지정된 컬럼 값의 순서대로 데이터 행을 저장하는 방법
2. 분포도 넓을수록 오히려 유리하고, 분포도가 넓은 테이블 클러스터링은 저장 공간의 절약이 가능
   (분포도가 넓다 = 분포도가 안 좋다.)
3. 액세스 효율 향상을 위한 물리적 저장 방법. 검색 효율은 높여주나 입력/수정/삭제 시 부하 증가

### 클러스터링 유형
| 유형 | 설명 |
| :--: | :--: |
| 단일<br>클러스터링 | 클러스터에 하나의 테이블만 생성<br>같은 클러스터 컬럼 값을 가진 row는 같은 장소에 저장되므로<br>넓은 범위의 데이터를 동시에 액세스할 때 효과적 |
| <br>다중<br>클러스터링 | 단일 클러스터에 두 개 이상의 테이블을 함께 저장<br>같은 클러스터 키 컬럼을 가진 각 테이블의 row는<br>정해진 장소에 같이 저장되므로 테이블 조인속도를 향상<br>클러스터 컬럼이 수정되면 데이터 값이 수정되므로<br>추가적인 클러스터 체인블록이 발생하여 효율 감소 |

### 클러스터링 설계 시 고려사항
1. 대량 범위를 자주 액세스 하는 경우
2. 인덱스 사용한 처리 부담이 되는 넓은 분포도
3. 여러 개 테이블이 자주 조인 일으킬 때
4. 반복 컬럼이 정규화에 의해 어쩔 수 없이 분할된 경우
5. UNION, DISTINCT, ORDER BY, GROUP BY 가 빈번한 컬럼이면 고려
6. 수정이 자주 발생하지 않는 컬럼

### 데이터베이스 백업 종류
1. 전체 백업 : 백업받고자 하는 데이터 전체에 대해 백업하는 방식
2. 차등 백업 : 마지막 전체 백업 이후 변경된 모든 데이터를 백업
3. 증분 백업 : 정해진 시간 기준 그 이후에 변경된 파일만을 백업
4. 트랜잭션 로그 백업 : 로그 파일에 기록된 로그를 백업하는 방식

## 물리 데이터 모델링

### 데이터베이스 무결성 종류
> 개참속사키

|       종류        |                                                   설명                                                   |              주요 기법               |
|:-----------------:|:--------------------------------------------------------------------------------------------------------:|:------------------------------------:|
|    개체 무결성    |            한 엔티티에서 PK를 가질 수 없거나, PK의 속성이<br>NULL을 허용할 수 없는 제약 조건             |       기본 키<br>유니크 인덱스       |
|    참조 무결성    |    외래 키가 참조하는 다른 개체의 기본 키에 해당하는<br>값이 기본 키 값이나 NULL이어야 하는 제약조건     |               왜래 키                |
|  <br>속성 무결성  | <br>속성의 값은 기본값, NULL 여부, 도메인(데이터 타입, 길이)<br>이 지정된 규칙을 준수해야 하는 제약 조건 | 체크<br>NULL<br>NOT NULL<br>기본 값  |
| <br>사용자 무결성 |                          <br>사용자의 의미적 요구사항을 준수해야 하는 제약 조건                          | 트리거<br>사용자 정의<br>데이터 타입 |
|     키 무결성     |                  한 릴레이션에 같은 키 값을 가진 튜플들을 <br>허용할 수 없는 제약 조건                   |                유니크                |
### 무결성 규성 (Integrity  Rule)
1. 데이터가 만족해야 될 제약 조건, 규정 참조할 때 사용하는 식별자 요소가 포함될 수 있음
2. 대상으로 도메인, 키, 종속성 등이 있음
3. 정식으로 허가 받은 사용자에 의한 갱신으로 DB 보호하기 위한 규정
4. 릴레이션 무결성 규정은 릴레이션 조작 과정에서의 의미적 관계를 명세한 것

## DB 반 정규화

### 반 정규화 
정규화된 엔티티, 속성, 관계에 대해 성능 향상과 개발 운영의 단순화를 위해
**중복, 통합, 분리 등을 수행하는 데이터 모델링**의 기법

### 반 정규화 유형 중 중복 테이블을 추가하는 방법
1. 집계 테이블 추가
2. 진행 테이블 추가
3. 특정 부분만을 포한하는 데이터 추가

## 물리 데이터 모델 품질 검토

### CRUD 매트릭스 규칙
1. 엔티티 타입
* **모든 엔티티에 "C" 존재** : 데이터 1번 생성되어야 함, 생성이 없으면 읽기,갱신,삭제 불가능
* **모든 엔티티에 "R" 존재** : 데이터 최소 1번 읽어야 함
* **모든 엔티티에 "CRUD" 존재** : C, R, U, D 중 하나라도 존재해야 함
2. 프로세스
* 두개 이상 단위 프로세스가 하나 엔티티 타입 생성 불가 : 두개 이상 "C" 존재하면 안됨
* 모든 단위 프로세스는 하나 이상 엔티티 타입 표기 : 단위 프로세스에 CRUD 중 하나는 있어야 함

### 성능 튜닝 기법
> 옵힌 부틴 (등에 업힌(옵힌) 부인)

1. 옵티마이저 조정
2. 힌트 사용
3. 부분 범위 처리 사용
4. 인덱스 활용

### CRUD 분석

데이터베이스에 영향을 주는 생성, 읽기, 갱신, 삭제 연산으로
프로세스와 테이블 간 매트릭스를 만들어 트랜잭션을 분리하는 기법

*** 
*DAS (Direct Attached Storage) : 케이블 통해 서버/PC에 직접 연결된 전용 디지털 저장장치*

```
ATA, SATA, SCSI, SAS 는 DAS 연결에 사용되는 기본 프로토콜
NFS, CIFS, SMB 는 NAS에서 사용하는 프로토콜
```
***

| 보기 | 설명 |
| ---- | ---- |
| ETL | 데이터 분석 위한 데이터 저장소인 DW/DM으로 이동시키기 위해<br>소스 시스템으로부터 필요한 원본 데이터를 추출하고 변환하여 적재하는 작업 |
| FTP | TCP/IP 프로토콜을 가지고 서버/클라이언트 사이 파일 전송 위한 프로토콜 |
| OLAP | 사용자가 동일 데이터를 여러 기준을 이용하는 다양한 방식으로 바라보면서<br>다차원 데이터 분석을 할 수 있도록 도와주는 기술 |
| UDP | 비연결성, 신뢰성 없으며, 순서화되지 않은 데이터그램 서비스 제공하는 4계층 프로토콜 |
